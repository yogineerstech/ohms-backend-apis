meta {
  name: Get Test Patient
  type: http
  seq: 2
}

get {
  url: http://localhost:3000/api/v1/patients/search
  body: none
  auth: bearer
}

headers {
  Content-Type: application/json
}

auth:bearer {
  token: {{authToken}}
}

tests {
  test("Status should be 200", function() {
    expect(res.getStatus()).to.equal(200);
  });
  
  test("Should return patient data", function() {
    expect(res.getBody().success).to.equal(true);
  });
  
  // Store a test patient ID if available
  if (res.getBody().success && res.getBody().data.patients && res.getBody().data.patients.length > 0) {
    const patient = res.getBody().data.patients[0];
    bru.setVar("testPatientId", patient.id);
    console.log("âœ… Test patient ID stored:", patient.id);
    console.log("ğŸ‘¤ Patient:", patient.firstName, patient.lastName);
  } else {
    // Use a mock patient ID for testing
    bru.setVar("testPatientId", "test-patient-id-12345");
    console.log("âš ï¸ No patients found, using mock patient ID");
  }
}
